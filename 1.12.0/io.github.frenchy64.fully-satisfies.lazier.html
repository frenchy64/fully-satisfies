<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>io.github.frenchy64.fully-satisfies.lazier documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Fully-satisfies</span> <span class="project-version">1.12.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>github</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>frenchy64</span></div></div></li><li class="depth-4"><a href="io.github.frenchy64.fully-satisfies.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fully-satisfies</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.clearing-future.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clearing-future</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.everyp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>everyp</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.expand-kvs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>expand-kvs</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.folda.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>folda</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.head-releasing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>head-releasing</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.latest-protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>latest-protocol</span></div></a></li><li class="depth-5 branch current"><a href="io.github.frenchy64.fully-satisfies.lazier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lazier</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.leaky-seq-detection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>leaky-seq-detection</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.linear.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>linear</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.never.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>never</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>non-leaky-macros</span></div></div></li><li class="depth-6"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clojure</span></div></div></li><li class="depth-7"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-8 branch"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.core.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-8"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logic</span></div></div></li><li class="depth-9"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.core.logic.pldb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pldb</span></div></a></li><li class="depth-8"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>match</span></div></div></li><li class="depth-9"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.core.match.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-7"><div class="no-link"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>java</span></div></div></li><li class="depth-8 branch"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.java.jmx.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jmx</span></div></a></li><li class="depth-8"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.java.shell.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shell</span></div></a></li><li class="depth-7 branch"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.pprint.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>pprint</span></div></a></li><li class="depth-7"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-8"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>check</span></div></div></li><li class="depth-9 branch"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.test.check.generators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generators</span></div></a></li><li class="depth-9"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.test.check.properties.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>properties</span></div></a></li><li class="depth-8"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.test.tap.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>tap</span></div></a></li><li class="depth-7"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>tools</span></div></div></li><li class="depth-8"><a href="io.github.frenchy64.fully-satisfies.non-leaky-macros.clojure.tools.trace.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>trace</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.partially-satisfies.html"><div class="inner"><span class="tree" style="top: -579px;"><span class="top" style="height: 588px;"></span><span class="bottom"></span></span><span>partially-satisfies</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.reify-spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reify-spec</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.requiring-resolve.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>requiring-resolve</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.run-all.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run-all</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.safe-locals-clearing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>safe-locals-clearing</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.safer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>safer</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.shared-protocol.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shared-protocol</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.somef.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>somef</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.uncaught-testing-contexts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uncaught-testing-contexts</span></div></a></li><li class="depth-5 branch"><a href="io.github.frenchy64.fully-satisfies.uniform.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>uniform</span></div></a></li><li class="depth-5"><a href="io.github.frenchy64.fully-satisfies.vector-overflow.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector-overflow</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-bounded-count"><div class="inner"><span>bounded-count</span></div></a></li><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-bounded-count.27"><div class="inner"><span>bounded-count'</span></div></a></li><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-cycle"><div class="inner"><span>cycle</span></div></a></li><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-dedupe"><div class="inner"><span>dedupe</span></div></a></li><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-iterator-seq"><div class="inner"><span>iterator-seq</span></div></a></li><li class="depth-1"><a href="io.github.frenchy64.fully-satisfies.lazier.html#var-sequence"><div class="inner"><span>sequence</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">io.github.frenchy64.fully-satisfies.lazier</h1><div class="doc"><pre class="plaintext">Variants of clojure.core functions that are slightly lazier when
processing and/or returning lazy seqs.

Some common (anti)patterns were to blame for the less-lazy versions of
these functions. The main insight was that if you are using a counter to
bound how many elements of a seq you are walking, you can be lazier by
testing the counter _before_ testing for more elements. For example, 

```java
int n = 0;
while(iter.hasNext() &amp;&amp; n &lt; CHUNK_SIZE)
```

will force n+1 elements and

```java
int n = 0;
while(n &lt; CHUNK_SIZE &amp;&amp; iter.hasNext())
```

will force n elements. In this case, realizing the extra element has no utility because
the chunk only fits CHUNK_SIZE elements.

Another problematic pattern was using seq-based implementations for sequence functions.
Seqs must be non-empty, but a sequence can be empty, so implementations can be lazier.</pre></div><div class="public anchor" id="var-bounded-count"><h3>bounded-count</h3><h4 class="added">added in 1.9</h4><div class="usage"><code>(bounded-count n coll)</code></div><div class="doc"><pre class="plaintext">If coll is counted? returns its count, else will count at most the first n
elements of coll using its seq.

lazier/bounded-count additionally:
- does not force coll if n==0
- forces at most n elements of a lazy seq instead of n+1.</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L82">view source</a></div></div><div class="public anchor" id="var-bounded-count.27"><h3>bounded-count'</h3><div class="usage"><code>(bounded-count' n coll)</code></div><div class="doc"><pre class="plaintext">If coll is counted? returns its count, else will count at most the first n
elements of coll using its seq, short-circuiting if a counted? seq is found
within n-1 nexts.

lazier/bounded-count' additionally:
- does not force coll if n==0
- forces at most n elements of a lazy seq instead of n+1.</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L102">view source</a></div></div><div class="public anchor" id="var-cycle"><h3>cycle</h3><h4 class="added">added in 1.0</h4><div class="usage"><code>(cycle coll)</code></div><div class="doc"><pre class="plaintext">Returns a lazy (infinite!) sequence of repetitions of the items in coll.

lazier/cycle does not realize a lazy seq coll until it is needed.</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L72">view source</a></div></div><div class="public anchor" id="var-dedupe"><h3>dedupe</h3><h4 class="added">added in 1.7</h4><div class="usage"><code>(dedupe)</code><code>(dedupe coll)</code></div><div class="doc"><pre class="plaintext">Returns a lazy sequence removing consecutive duplicates in coll.
Returns a transducer when no collection is provided.

lazier/dedupe additionally:
- does not force a lazy seq until needed
- forces 32 elements per chunk instead of 33, preserving 32 elements
per chunk.
- transducer arity behaves correctly for all inputs (including :clojure.core/none)</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L140">view source</a></div></div><div class="public anchor" id="var-iterator-seq"><h3>iterator-seq</h3><h4 class="added">added in 1.0</h4><div class="usage"><code>(iterator-seq iter)</code></div><div class="doc"><pre class="plaintext">Returns a seq on a java.util.Iterator. Note that most collections
providing iterators implement Iterable and thus support seq directly.
Seqs cache values, thus iterator-seq should not be used on any
iterator that repeatedly returns the same mutable object.

lazier/iterator-seq additionally:
- forces 32 elements per chunk instead of 33, preserving 32 elements
  per chunk.</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L125">view source</a></div></div><div class="public anchor" id="var-sequence"><h3>sequence</h3><h4 class="added">added in 1.0</h4><div class="usage"><code>(sequence coll)</code><code>(sequence xform coll)</code><code>(sequence xform coll &amp; colls)</code></div><div class="doc"><pre class="plaintext">Coerces coll to a (possibly empty) sequence, if it is not already
one. Will not force a lazy seq. (sequence nil) yields (). When a
transducer is supplied, returns a lazy sequence of applications of
the transform to the items in coll(s), i.e. to the set of first
items of each coll, followed by the set of second
items in each coll, until any one of the colls is exhausted.  Any
remaining items in other colls are ignored. The transform should accept
number-of-colls arguments.

lazier/sequence additionally:
- avoids realizing the first element of the return until it is needed.
- realizes 32 elements per chunk instead of 33, preserving 32 elements
  per chunk.
- fixes a comma in the docstring.</pre></div><div class="src-link"><a href="https://github.com/frenchy64/fully-satisfies/blob/861204be79767cd8430f43146aef52f0763eb466/src/io/github/frenchy64/fully_satisfies/lazier.clj#L40">view source</a></div></div></div></body></html>